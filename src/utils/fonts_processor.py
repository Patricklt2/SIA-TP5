import numpy as np
import matplotlib.pyplot as plt

WIDTH = 5
HEIGHT = 7
FEATURES = WIDTH * HEIGHT

FONT_DATA_HEX_RAW = [
   [0x04, 0x04, 0x02, 0x00, 0x00, 0x00, 0x00],
   [0x00, 0x0e, 0x01, 0x0d, 0x13, 0x13, 0x0d],
   [0x10, 0x10, 0x10, 0x1c, 0x12, 0x12, 0x1c],
   [0x00, 0x00, 0x00, 0x0e, 0x10, 0x10, 0x0e],
   [0x01, 0x01, 0x01, 0x07, 0x09, 0x09, 0x07],
   [0x00, 0x00, 0x0e, 0x11, 0x1f, 0x10, 0x0f],
   [0x06, 0x09, 0x08, 0x1c, 0x08, 0x08, 0x08],
   [0x0e, 0x11, 0x13, 0x0d, 0x01, 0x01, 0x0e],
   [0x10, 0x10, 0x10, 0x16, 0x19, 0x11, 0x11],
   [0x00, 0x04, 0x00, 0x0c, 0x04, 0x04, 0x0e],
   [0x02, 0x00, 0x06, 0x02, 0x02, 0x12, 0x0c],
   [0x10, 0x10, 0x12, 0x14, 0x18, 0x14, 0x12],
   [0x0c, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04],
   [0x00, 0x00, 0x0a, 0x15, 0x15, 0x11, 0x11],
   [0x00, 0x00, 0x16, 0x19, 0x11, 0x11, 0x11],
   [0x00, 0x00, 0x0e, 0x11, 0x11, 0x11, 0x0e],
   [0x00, 0x1c, 0x12, 0x12, 0x1c, 0x10, 0x10],
   [0x00, 0x07, 0x09, 0x09, 0x07, 0x01, 0x01],
   [0x00, 0x00, 0x16, 0x19, 0x10, 0x10, 0x10],
   [0x00, 0x00, 0x0f, 0x10, 0x0e, 0x01, 0x1e],
   [0x08, 0x08, 0x1c, 0x08, 0x08, 0x09, 0x06],
   [0x00, 0x00, 0x11, 0x11, 0x11, 0x13, 0x0d],
   [0x00, 0x00, 0x11, 0x11, 0x11, 0x0a, 0x04],
   [0x00, 0x00, 0x11, 0x11, 0x15, 0x15, 0x0a],
   [0x00, 0x00, 0x11, 0x0a, 0x04, 0x0a, 0x11],
   [0x00, 0x11, 0x11, 0x0f, 0x01, 0x11, 0x0e],
   [0x00, 0x00, 0x1f, 0x02, 0x04, 0x08, 0x1f],
   [0x06, 0x08, 0x08, 0x10, 0x08, 0x08, 0x06],
   [0x04, 0x04, 0x04, 0x00, 0x04, 0x04, 0x04],
   [0x0c, 0x02, 0x02, 0x01, 0x02, 0x02, 0x0c],
   [0x08, 0x15, 0x02, 0x00, 0x00, 0x00, 0x00],
   [0x1f, 0x1f, 0x1f, 0x1f, 0x1f, 0x1f, 0x1f]
]

def load_fonts():
    font_data_hex = np.array(FONT_DATA_HEX_RAW, dtype=np.uint8)

    patterns_binary = np.zeros((len(font_data_hex), FEATURES), dtype=np.float32)

    for i, pattern in enumerate(font_data_hex):
        pattern_vector = []
        for row_byte in pattern:
            binary_string = format(row_byte, f'0{WIDTH}b')
            pattern_vector.extend([int(bit) for bit in binary_string])
        
        patterns_binary[i] = np.array(pattern_vector, dtype=np.float32)

    return patterns_binary

def visualize_pattern(vector_35, title="Patron"):
    if vector_35.ndim == 2 and vector_35.shape[1] == FEATURES:
        vector_35 = vector_35.flatten() 
    
    matrix_7x5 = vector_35.reshape(HEIGHT, WIDTH)
    
    plt.imshow(matrix_7x5, cmap='binary', interpolation='nearest')
    plt.title(title)
    plt.xticks([])
    plt.yticks([])
    plt.show()

def get_char_labels():
    # 0x60 ('`') - 0x7F ('DEL')
    return [chr(i) for i in range(0x60, 0x7f + 1)]

# Para ver como se arman las letras no mas.. pareceria estar OK ?)
#if __name__ == '__main__':
#    data = load_fonts() 
#    
#    first_pattern = data[0]
#    
#    plt.figure(figsize=(3, 5))
#    plt.imshow(visualize_pattern(first_pattern), cmap='gray_r')
#    plt.title(f"Patr√≥n 0 ('`') - Forma 7x5")
#    plt.show()